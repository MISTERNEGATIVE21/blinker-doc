# 固件升级(OTA)  

## 使用ESP8266/ESP32的固件更新  

### OTA状态  
设备有如下OTA状态：  
0: 等待升级  
1: 固件下载中  
99: 固件更新中  
100: 固件更新完成  
-1: 固件更新失败  
-2: 固件下载失败  

### OTA流程实现  
1. App比对当前设备固件版本和云端固件版本，如云端版本号更高，则提示有更新可用  
2. 用户在App上点击“立即更新”，App会向设备发送`{"set":{"upgrade":true}}`  
3. 设备收到后，即会启动固件更新功能，向服务器上报OTA状态1，并从云端下载最新版本固件  
4. 下载完成后，设备向服务器上报OTA状态99，并开始更新固件到应用Flash区  
5. 更新完成后，设备重启并向服务器上报OTA状态100  

## Linux设备的应用更新  
待写  